"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var mongoose = require("mongoose");
var serverConfig = require("../config/serverConfig");
var logger_1 = require("./logger");
var logger = new logger_1.default("Database");
var Database = (function () {
    function Database() {
        this.initialize();
        this.connect();
    }
    Database.prototype.initialize = function () {
        mongoose.connection.on("connected", function (ref) {
            logger.info("Connected to DB " + serverConfig.DB_NAME);
        });
        // If the connection throws an error
        mongoose.connection.on("error", function (err) {
            logger.error('Failed to connect to DB ' + serverConfig.DB_NAME + ' on startup ' + err);
        });
        // When the connection is disconnected
        mongoose.connection.on('disconnected', function () {
            logger.info('Mongoose default connection to DB :' + serverConfig.DB_NAME + ' disconnected');
        });
        // If the Node process ends, close the Mongoose connection
        process.on('SIGINT', this.gracefulExit).on('SIGTERM', this.gracefulExit);
    };
    Database.prototype.gracefulExit = function () {
        mongoose.connection.close(function () {
            logger.info('Mongoose default connection with DB :' + serverConfig.DB_NAME + ' is disconnected through app termination');
            process.exit(0);
        });
    };
    Database.prototype.connect = function () {
        this.database = mongoose.connect(serverConfig.DB_URL);
    };
    return Database;
}());
exports.default = Database;
//# sourceMappingURL=database.js.map